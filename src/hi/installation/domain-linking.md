# डोमेन नामों का बंधन

## क्लाउडफ्लेयर

बस अपने सर्वर के आईपी पते पर डोमेन प्रॉक्सीइंग जोड़ें

## एनगिनक्स

- एनगिनक्स स्थापित करें और कॉन्फ़िगर करें।
- अपने मुख्य डोमेन के लिए एक एसएसएल प्रमाणपत्र प्राप्त करें (उदाहरण के लिए, `सर्टबॉट` का उपयोग करके)।
- सुनिश्चित करें कि आपकी साइट `https://आपका_डोमेन` पर उपलब्ध है।

## व्यापारी को कॉन्फ़िगर करना और पुनः आरंभ करना

- व्यापारी कॉन्फ़िगरेशन फ़ाइल खोलें:

  ```bash
  nano /home/dv/merchant/configs/config.yaml
  ```

- निम्नलिखित पंक्तियाँ जोड़ें (या संशोधित करें):

  ```yaml
  http:
    port: "8080"
  ```

- परिवर्तनों को सहेजें और बैकएंड को पुनः आरंभ करें:

  ```bash
  sudo systemctl restart dv-merchant
  ```

## सबडोमेन के लिए एनगिनक्स कॉन्फ़िगर करना

- सबडोमेन के लिए एक एनगिनक्स कॉन्फ़िगरेशन फ़ाइल बनाएँ:

  ```bash
  nano /etc/nginx/conf.d/{आपका_डोमेन या सबडोमेन}.conf
  ```

- निम्नलिखित ब्लॉक को इसमें चिपकाएँ (`प्रॉक्सी_पास` में पोर्ट को आवश्यकतानुसार समायोजित करें):

  ```nginx
  server {
      listen 80;
      server_name {आपका_डोमेन};

      client_max_body_size 128M;

      access_log  /var/log/nginx/{आपका_डोमेन}.access.log;
      error_log   /var/log/nginx/{आपका_डोमेन}.error.log;

      location / {
          proxy_pass http://localhost:8080;
      }

      location ~ /\.(ht|svn|git) {
          deny all;
      }

      #Cloudflare proxy mode

      set_real_ip_from 103.21.244.0/22;
      set_real_ip_from 103.22.200.0/22;
      set_real_ip_from 103.31.4.0/22;
      set_real_ip_from 104.16.0.0/12;
      set_real_ip_from 108.162.192.0/18;
      set_real_ip_from 131.0.72.0/22;
      set_real_ip_from 141.101.64.0/18;
      set_real_ip_from 162.158.0.0/15;
      set_real_ip_from 172.64.0.0/13;
      set_real_ip_from 173.245.48.0/20;
      set_real_ip_from 188.114.96.0/20;
      set_real_ip_from 190.93.240.0/20;
      set_real_ip_from 197.234.240.0/22;
      set_real_ip_from 198.41.128.0/17;
      set_real_ip_from 2400:cb00::/32;
      set_real_ip_from 2606:4700::/32;
      set_real_ip_from 2803:f800::/32;
      set_real_ip_from 2405:b500::/32;
      set_real_ip_from 2405:8100::/32;
      set_real_ip_from 2c0f:f248::/32;
      set_real_ip_from 2a06:98c0::/29;

      real_ip_header CF-Connecting-IP;
  }
  ```

- परिवर्तनों को सहेजें और एनगिनक्स को पुनः लोड करें:

  ```bash
  sudo nginx -s reload
  ```

## डीएनएस कॉन्फ़िगर करना

- अपने होस्टिंग (या डोमेन रजिस्ट्रार) की डीएनएस सेटिंग्स में, सबडोमेन `{आपका_डोमेन या सबडोमेन}` को अपने सर्वर के आईपी पते से बाँधें। उदाहरण के लिए, एक ए रिकॉर्ड का उपयोग करके:

  ```
  {आपका_डोमेन या सबडोमेन}    A     आपका_सर्वर_आईपी
  ```

## सबडोमेन के लिए एसएसएल प्रमाणपत्र जारी करना

- जब डीएनएस रिकॉर्ड अपडेट हो जाए और सर्वर की ओर इशारा करे, तो एक प्रमाणपत्र जारी करें:

  ```bash
  sudo certbot --nginx -d {आपका_डोमेन या सबडोमेन}
  ```

## स्थिति जांच और अंतिम कॉन्फ़िगरेशन

- सुनिश्चित करें कि बैकएंड सफलतापूर्वक शुरू हो गया है:

  ```bash
  systemctl status dv-merchant
  ```

- `http://{आपका_डोमेन या सबडोमेन}` (या `https://{आपका_डोमेन या सबडोमेन}`, यदि प्रमाणपत्र सफलतापूर्वक जारी किया गया है) पर जाएँ और ब्राउज़र में व्यापारी को कॉन्फ़िगर करना जारी रखें।