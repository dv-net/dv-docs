# Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¥Ù„Ù‰ api.dv.net

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

ÙŠØªÙØ§Ø¹Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¹ Ø®Ø§Ø¯Ù… `api.dv.net` Ù„ØªÙ†ÙÙŠØ° Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ:

- ðŸ“§ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø§Ø¯Ù… SMTP Ø®Ø§Øµ Ø¨Ùƒ
- ðŸ“± Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Telegram Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©
- ðŸ“Š Ø¬Ù…Ø¹ Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª ÙˆØ§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø¹Ù† Ø¨ÙØ¹Ø¯ Ù„ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…
- ðŸ”„ Ø¥Ø¯Ø§Ø±Ø© Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª

## Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø®ØµÙˆØµÙŠØ©

Ù…Ù‡Ù…: Ù†Ø¶Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„ØªØ§Ù… Ù„Ø¨ÙŠØ§Ù†Ø§ØªÙƒ. Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù†Ø§ØŒ Ù„Ø§ ÙŠØªÙ… Ù…Ø·Ù„Ù‚Ù‹Ø§ Ø¥Ø±Ø³Ø§Ù„ Ù…Ø§ ÙŠÙ„ÙŠ:

- Ø¹Ø¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©
- Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø®Ø§ØµØ©
- ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ©
- ÙˆØ£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø®Ø±Ù‰ Ù‚Ø¯ ØªØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø³ÙŠØ·Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§ÙØ¸ Ø£Ùˆ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª

ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ù†ÙØ³Ùƒ Ù…Ù† ØªÙ†ÙÙŠØ° Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ù…Ù† Ø®Ù„Ø§Ù„ ÙØ­Øµ Ø§Ù„Ø´ÙØ±Ø© Ø§Ù„Ù…ØµØ¯Ø±ÙŠØ© Ù„Ù„Ù…Ø´Ø±ÙˆØ¹:  
[https://github.com/dv-net](https://github.com/dv-net)

## ØªÙ…ÙƒÙŠÙ† Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…

### Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙƒÙˆÙŠÙ†

Ø£Ø¶Ù Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ `log_status: true` Ø¥Ù„Ù‰ Ù‚Ø³Ù… `admin` ÙÙŠ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ†:

```yaml
# /home/dv/merchant/configs/config.yaml

admin:
  log_status: true
  # other admin section parameters...
```

### Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©

Ø¨Ø¹Ø¯ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªÙƒÙˆÙŠÙ†ØŒ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª:

```bash
sudo systemctl restart dv-merchant
```

## Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª

### Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1: Ø³Ø·Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø± (journalctl)

Ø§Ø³ØªØ®Ø¯Ù… Ø³Ø¬Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø¹Ø±Ø¶ Ø³Ø¬Ù„Ø§Øª Ø·Ù„Ø¨Ø§Øª API:

```bash
# View all API-related entries
journalctl -u dv-merchant | grep 'DV-API'

# Real-time monitoring
journalctl -u dv-merchant -f | grep 'DV-API'

# View entries from the last hour with timestamps
journalctl -u dv-merchant --since "1 hour ago" | grep 'DV-API'
```

### Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2: ÙˆØ§Ø¬Ù‡Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆÙŠØ¨

Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø°Ù„ÙƒØŒ ÙŠÙ…ÙƒÙ† Ø¹Ø±Ø¶ Ø¢Ø®Ø± 1000 Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙˆØªØµÙÙŠØªÙ‡Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹ ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆÙŠØ¨:

![api-requests-logging.png](../../assets/images/security/api-requests-logging.png)

## Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªÙ‚Ø¯Ù… Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª

### Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Promtail + Loki + Grafana

```yaml
# /etc/promtail/config.yaml

scrape_configs:
  - job_name: dv-merchant
    static_configs:
      - targets:
          - localhost
        labels:
          job: dv-merchant
          __path__: /var/log/dv-merchant/*.log
```

### Ø¥Ø¹Ø¯Ø§Ø¯ Logstash

```ruby
input {
  file {
    path => "/var/log/dv-merchant/api.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
  }
}

filter {
  grok {
    match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:loglevel}.*DV-API.*" }
  }
}

output {
  elasticsearch {
    hosts => ["localhost:9200"]
    index => "dv-api-logs-%{+YYYY.MM.dd}"
  }
}
```

### Ø¥Ø¹Ø¯Ø§Ø¯ Grafana Alloy

```yaml
logs:
  positions_directory: /var/lib/grafana-agent-positions

  configs:
    - name: dv-merchant-logs
      scrape_configs:
        - job_name: dv-merchant-api
          static_configs:
            - targets: [localhost]
              labels:
                job: dv-merchant
                __path__: /var/log/dv-merchant/*.log
```